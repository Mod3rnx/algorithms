<!DOCTYPE html>
<html>
<body>

<h2>My Heading</h2>

<p>Play around with the code and click on the "Run" button to view the result.</p>

<p id="demo"></p>
<p id="demo1"></p>


<script>


  class Node {
    constructor(name) {
      this.name = name
      this.checked = false
      this.cost = Infinity
      this.pairs = []
    }
    isChecked() {
      return this.checked
    }
    setChecked() {
      return this.checked = true
    }
    setCost(val) {
      return this.cost = val
    }
    getCost() {
      return this.cost
    }
    getPairs() {
      return this.pairs
    }
    getName() {
      return this.name
    }
    createPair(node, bidirectional, weight) {
      if(bidirectional) {
        node.pairs.push([this, bidirectional, weight])
      }
      this.pairs.push([node, bidirectional, weight])
    }
  }

  class Graph {
    constructor(...nodes) {
      this.nodes = nodes
    }

    findPath(end) {
      return end.getCost()
    }

    findDijkstra(prevNode, endPoint) {
      if(endPoint) { //if endPoint exists
        if(prevNode.getPairs().length === 0 || endPoint.getPairs().length === 0) {
          return `something isn't connected`
        } else {
          let currentNode = prevNode
          if (currentNode.getCost() === Infinity) currentNode.setCost(0)
          currentNode.setChecked()
          let neighbors = currentNode.getPairs().map((neighbor) => {
            if(!neighbor[0].isChecked()) {
              if(neighbor[0].getCost() > currentNode.getCost() + neighbor[2]) {
                neighbor[0].setCost(neighbor[2] + currentNode.getCost())
              } else if (neighbor[0].getCost() === Infinity) {
                neighbor[0].setCost(neighbor[2])
              }
            }
            return neighbor
          })
          let neighborsCosts = currentNode.pairs.map((neighbor) => {
            if(!neighbor[0].isChecked()) {
              return neighbor[2]
            } else return Infinity
          })
          let everythingInfinity = (currentValue) => currentValue === Infinity
          let infinityCheck = neighborsCosts.every(everythingInfinity)
          if(infinityCheck) {
            return
          }
          let cheapestNeighborIndex = neighborsCosts.indexOf(Math.min(...neighborsCosts))
          let nextNode = neighbors[cheapestNeighborIndex][0]
          this.findDijkstra(nextNode, endPoint)
          return this.findPath(endPoint)
        }
      } else { //no endPoint
        if(prevNode.getPairs().length === 0){
          return `${prevNode} is not connected`
        } else {
          let currentNode = prevNode
          if (currentNode.getCost() === Infinity) currentNode.setCost(0)
          currentNode.setChecked()
          let neighbors = currentNode.getPairs().map((neighbor) => {
            if(!neighbor[0].isChecked()) {
              if(neighbor[0].getCost() > currentNode.getCost() + neighbor[2]) {
                neighbor[0].setCost(neighbor[2] + currentNode.getCost())
              } else if (neighbor[0].getCost() === Infinity) {
                neighbor[0].setCost(neighbor[2])
              }
            }
            return neighbor
          })
          let neighborsCosts = currentNode.pairs.map((neighbor) => {
            if(!neighbor[0].isChecked()) {
              return neighbor[2]
            } else return Infinity
          })
          let everythingInfinity = (currentValue) => currentValue === Infinity
          let infinityCheck = neighborsCosts.every(everythingInfinity)
          if(infinityCheck) {
            return
          }
          let cheapestNeighborIndex = neighborsCosts.indexOf(Math.min(...neighborsCosts))
          let nextNode = neighbors[cheapestNeighborIndex][0]
          this.findDijkstra(nextNode)
          return this.nodes
        }
      }
    }
  }
  let node1 = new Node("1")
  let node2 = new Node("2")
  let node3 = new Node("3")
  let node4 = new Node("4")
  let node5 = new Node("5")
  let node6 = new Node("6")
  let node7 = new Node("7")
  node1.createPair(node2, true, 7)
  node1.createPair(node3, true, 9)
  node1.createPair(node6, true, 14)
  node2.createPair(node3, true, 10)
  node2.createPair(node4, true, 15)
  node3.createPair(node4, true, 11)
  node3.createPair(node6, true, 2)
  node4.createPair(node5, true, 6)
  node5.createPair(node6, true, 9)
  let graph1 = new Graph(node1, node2, node3, node4, node5, node6)

  var t0 = performance.now()
  let allPaths = graph1.findDijkstra(node6, node1)
  console.log(allPaths)
  var t1 = performance.now()
  console.log("Call to doSomething took " + (t1 - t0) + " milliseconds.")

</script>

</body>
</html>
